import { NavLink, useLocation } from 'react-router-dom';
import { useUser } from "../../context/userContext";
import LogoStroke from '../LogoStroke/LogoStroke';


export default function Sidebar() {
    const { usuario,logout } = useUser();
    const location = useLocation();

    
    
    // Lista de enlaces con sus roles permitidos
    const links = [
        {
            id: 0,
            name: "Inicio",
            path: "/dashboard",
            icon:
                <svg xmlns="http://www.w3.org/2000/svg" width="26" height="20" viewBox="0 0 28 24" fill="none">
                    <path className='fill-cream' d="M24.9043 9.80066L26.3902 10.9436C26.5723 11.0833 26.7866 11.1506 26.9995 11.1506C27.2993 11.1506 27.5957 11.0159 27.7925 10.76C28.1294 10.3225 28.0474 9.69458 27.6099 9.35767L16.5864 0.878174C15.063 -0.293701 12.9361 -0.291748 11.4136 0.878174L0.390154 9.35767C-0.0473465 9.69458 -0.129378 10.3225 0.207536 10.76C0.543962 11.1995 1.17287 11.2795 1.60988 10.9436L3.10011 9.7973V18.8811C3.10011 21.219 5.00197 23.1213 7.33986 23.1213H10C10.5523 23.1213 11 22.6741 11 22.1213V16.1213C11 15.5696 11.4487 15.1213 12 15.1213H16C16.5513 15.1213 17 15.5696 17 16.1213V22.1208C17 22.6736 17.4478 23.1213 18 23.1213H20.6602C22.9981 23.1213 24.8999 21.219 24.8999 18.8811C24.8999 18.8085 24.9043 9.80066 24.9043 9.80066Z" fill="white"/>
                </svg>
            ,
            allowedRoles: ['admin', 'encargado', 'empleado'] // Todos pueden ver categorías
        },{
            id: 1,
            name: "Categorías",
            path: "/dashboard/categorias",
            icon:
                <svg xmlns="http://www.w3.org/2000/svg" width="19" height="19" viewBox="0 0 19 19" fill="none">
                    <path className='fill-cream' d="M6.68878 0.48003C5.91327 0.28811 4.94388 0.0961914 4.16838 0.0961914C3.39286 0.0961914 2.42347 0.28811 1.64796 0.48003C0.96939 0.575989 0.48469 1.15175 0.387752 1.82346C0.290814 2.59114 0 4.12649 0 5.18205C0 6.2376 0.193876 7.58105 0.290814 8.54063C0.387752 9.21238 0.872452 9.78808 1.55102 9.88403C2.22959 10.076 3.29592 10.172 4.07143 10.172C4.84694 10.172 5.81633 9.98007 6.59185 9.88403C7.27041 9.78808 7.75514 9.21238 7.85204 8.54063C8.04594 7.58105 8.14284 6.2376 8.14284 5.18205C8.14284 4.12649 7.94894 2.59114 7.85204 1.82346C7.85204 1.15175 7.36735 0.575989 6.68878 0.48003Z" fill="white"/>
                    <path className='fill-cream' d="M17.3516 9.11598C16.673 8.92408 15.6068 8.82812 14.8313 8.82812C14.0557 8.82812 13.0863 9.02003 12.3108 9.11598C11.6322 9.21193 11.1476 9.78772 11.0507 10.4595C10.8568 11.4191 10.7598 12.7625 10.7598 13.818C10.7598 14.8735 10.9537 16.217 11.0507 17.1766C11.1476 17.8483 11.6322 18.4241 12.3108 18.52C12.9894 18.7119 14.0557 18.8079 14.8313 18.8079C15.6068 18.8079 16.5761 18.616 17.3516 18.52C18.0302 18.4241 18.5149 17.8483 18.6118 17.1766C18.8057 16.217 18.9027 14.8735 18.9027 13.818C18.9027 12.7625 18.8057 11.4191 18.6118 10.4595C18.5149 9.78772 18.0302 9.21193 17.3516 9.11598Z" fill="white"/>
                    <path className='fill-cream' d="M6.78572 12.9544C6.01021 12.7625 5.04082 12.6665 4.16837 12.6665C3.29592 12.6665 2.32653 12.8584 1.55102 12.9544C0.96939 13.0503 0.48469 13.5301 0.290814 14.1059C0.096938 14.7776 0 15.3534 0 15.8331C0 16.313 0.096938 16.7927 0.290814 17.5604C0.48469 18.1362 0.96939 18.52 1.55102 18.7119C2.32653 18.9039 3.29592 18.9999 4.16837 18.9999C5.04082 18.9999 6.01021 18.8079 6.78572 18.7119C7.36735 18.616 7.85204 18.1362 8.04594 17.5604C8.23983 16.8887 8.33673 16.313 8.33673 15.8331C8.33673 15.3534 8.23983 14.8735 8.04594 14.1059C7.85204 13.4342 7.36735 13.0503 6.78572 12.9544Z" fill="white"/>
                    <path className='fill-cream' d="M12.215 6.04545C12.9906 6.23738 13.96 6.33334 14.8324 6.33334C15.7049 6.33334 16.6742 6.14142 17.4497 6.04545C18.0314 5.94949 18.5161 5.4697 18.71 4.89394C18.9039 4.22222 19.0008 3.64646 19.0008 3.16667C19.0008 2.68687 18.9039 2.20707 18.71 1.43939C18.5161 0.863636 18.0314 0.479798 17.4497 0.287879C16.6742 0.0959595 15.7049 0 14.8324 0C13.96 0 12.9906 0.191919 12.215 0.287879C11.6334 0.383838 11.1488 0.863636 10.9549 1.43939C10.761 2.11111 10.6641 2.68687 10.6641 3.16667C10.6641 3.64646 10.761 4.12626 10.9549 4.89394C11.1488 5.56565 11.6334 5.94949 12.215 6.04545Z" fill="white"/>
                </svg>         ,
            allowedRoles: ['admin', 'encargado', 'empleado'] // Todos pueden ver categorías
        },
        {
            id: 2,
            name: "Productos",
            path: "/dashboard/productos",
            icon:
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                <path className='fill-cream' d="M8.00032 10.0624C8.86734 10.0624 9.72056 10.1589 10.5619 10.351C11.4023 10.5441 12.1777 10.8506 12.8871 11.2713C13.5965 11.691 14.2044 12.2299 14.7128 12.887C15.2212 13.5432 15.5709 14.3275 15.764 15.2379C15.8163 15.4832 15.764 15.7019 15.6084 15.895C15.4517 16.0881 15.2497 16.1837 15.0015 16.1837H0.971519C0.724221 16.1837 0.522257 16.0881 0.365601 15.895C0.208947 15.7019 0.157713 15.4832 0.209931 15.2379C0.403039 14.3275 0.752792 13.5432 1.2612 12.887C1.7686 12.2299 2.37749 11.691 3.08687 11.2713C3.79625 10.8505 4.57557 10.5441 5.42486 10.351C6.27513 10.1589 7.13327 10.0624 8.00032 10.0624ZM0.892646 19.6519C0.652246 19.6519 0.443384 19.5633 0.266021 19.3849C0.0886769 19.2066 0 18.9967 0 18.7544C0 18.512 0.0886718 18.3031 0.266021 18.1287C0.443364 17.9533 0.652226 17.8656 0.892646 17.8656H15.0802C15.3216 17.8656 15.5305 17.9553 15.7079 18.1327C15.8852 18.311 15.9739 18.5218 15.9739 18.7632C15.9739 19.0056 15.8852 19.2145 15.7079 19.3898C15.5305 19.5642 15.3216 19.6519 15.0802 19.6519H0.892646ZM0.892646 23.12C0.652246 23.12 0.443384 23.0313 0.266021 22.853C0.0886769 22.6747 0 22.4648 0 22.2224C0 21.9801 0.0886718 21.7712 0.266021 21.5968C0.443364 21.4214 0.652226 21.3337 0.892646 21.3337H15.0802C15.3216 21.3337 15.5305 21.4234 15.7079 21.6007C15.8852 21.7791 15.9739 21.9899 15.9739 22.2313C15.9739 22.4737 15.8852 22.6825 15.7079 22.8579C15.5305 23.0323 15.3216 23.12 15.0802 23.12H0.892646ZM20.4665 23.12H18.3383C18.1147 23.12 17.9275 23.0451 17.7767 22.8934C17.626 22.7427 17.5501 22.5555 17.5501 22.3318V15.895C17.5501 14.1373 16.9856 12.6023 15.8555 11.2919C14.7254 9.98165 13.3116 9.09879 11.6121 8.6436C11.4722 8.60813 11.35 8.53424 11.2446 8.41995C11.1392 8.30664 11.0781 8.17955 11.0603 8.03964L10.7717 5.59622C10.7362 5.3509 10.7993 5.14497 10.9589 4.97848C11.1195 4.81197 11.3195 4.72921 11.5599 4.72921H16.0525V0.78821C16.0525 0.564558 16.1283 0.377362 16.2801 0.226608C16.4328 0.0748802 16.621 0 16.8456 0C17.0702 0 17.2565 0.0748802 17.4052 0.226608C17.554 0.377352 17.6289 0.564538 17.6289 0.78821V4.72921H22.2527C22.498 4.72921 22.695 4.81394 22.8438 4.98537C22.9926 5.15582 23.0497 5.35977 23.0153 5.59623L21.2546 22.4105C21.227 22.6075 21.1364 22.775 20.9847 22.913C20.8319 23.0509 20.6596 23.12 20.4665 23.12Z" fill="white"/>
            </svg>
            ,
            allowedRoles: ['admin', 'encargado', 'empleado'] // Todos pueden ver productos
        },
        {
            id: 3,
            name: "Ingredientes",
            path: "/dashboard/ingredientes",
            icon:
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="23" viewBox="0 0 24 23" fill="none">
                    <path className='fill-cream' d="M17.5579 3.60039L17.1165 3.78565C16.4395 4.069 16.039 4.43816 15.6943 4.81142C16.0104 4.95854 16.3141 5.14653 16.6029 5.37129C17.2473 5.89576 17.6818 6.46245 18.0224 7.2144L18.5346 8.33825L17.3086 8.18704C16.4299 8.08078 15.8414 8.27695 15.2707 8.4663C15.0377 8.54531 14.7993 8.62432 14.55 8.67881C14.5664 8.78234 14.5787 8.88723 14.5868 8.99076C14.6413 9.61194 14.5582 10.2427 14.343 10.8652C14.0556 11.6458 13.6632 12.2397 13.0625 12.8064L12.6579 13.1864L12.1988 12.8759C11.5163 12.4113 11.0328 11.8869 10.6309 11.1744C10.3625 10.6731 10.1895 10.1609 10.116 9.6351C9.83535 9.68414 9.55745 9.69367 9.285 9.70457C8.68562 9.72773 8.06444 9.75089 7.28115 10.1623L6.18728 10.7385L6.26765 9.50568C6.32078 8.68289 6.52647 8.00041 6.93787 7.29205C7.18716 6.88065 7.48004 6.52375 7.81787 6.22405C7.74023 6.15594 7.66394 6.08511 7.58902 6.01563C7.14765 5.60832 6.6913 5.18603 5.84536 4.92312L4.6643 4.55532L5.38764 3.91915C1.30366 5.14925 0 8.74147 0 12.7737C0 18.4215 5.24733 23 11.7207 23C18.1927 23 23.4414 18.4215 23.4414 12.7737C23.4414 8.61069 21.9388 4.65612 17.5579 3.60039Z" fill="white"/>
                    <path className='fill-cream' d="M8.62705 6.44474C8.19795 6.74307 7.83015 7.13267 7.53454 7.62171C7.24438 8.12029 7.01008 8.69788 6.95695 9.53157C8.69108 8.62023 9.77133 9.32178 10.7835 8.62704C10.7617 8.845 10.7562 9.06023 10.7753 9.27683C10.8121 9.79857 10.9619 10.3121 11.233 10.8162C11.5164 11.3188 11.8937 11.8133 12.5871 12.2833C13.1946 11.7098 13.4889 11.1608 13.6891 10.6186C13.8771 10.0792 13.9439 9.54928 13.8962 9.02754C13.8676 8.68834 13.7899 8.35323 13.6687 8.02221C14.7653 8.18023 15.5445 7.25527 17.3917 7.48276C17.0457 6.72127 16.622 6.26356 16.1752 5.89985C15.7257 5.54703 15.2448 5.31408 14.7367 5.1874C14.6318 5.16015 14.5283 5.14108 14.4206 5.12473C15.0609 4.58801 15.4723 3.70665 16.8495 3.13178C16.1698 2.64274 15.5745 2.45475 15.0064 2.36212C14.4397 2.27902 13.9071 2.31444 13.4031 2.45747C12.899 2.59642 12.4222 2.84026 11.9782 3.20126C11.8079 3.34565 11.643 3.51185 11.4837 3.69439C10.872 1.71778 10.15 0.14031 10.0846 0L9.61195 0.21932C9.62694 0.253376 10.3816 1.89623 11.0055 3.93005C10.9728 3.90008 10.9374 3.87148 10.902 3.84696C10.4266 3.52955 9.92935 3.33203 9.41306 3.24212C8.8995 3.14949 8.36278 3.16448 7.80835 3.3007C7.25119 3.44918 6.67769 3.69166 6.04834 4.24337C7.71708 4.76238 8.11213 5.81947 9.03164 6.2009C8.89269 6.27582 8.75647 6.35483 8.62705 6.44474ZM12.0953 5.43805C12.1021 5.43805 12.1089 5.44213 12.1144 5.4435C12.0899 5.45439 12.064 5.46802 12.0395 5.48028C12.0572 5.46665 12.0762 5.45303 12.0953 5.43805Z" fill="white"/>
                </svg>           ,
            allowedRoles: ['admin', 'encargado', 'empleado'] // Todos pueden ver ingredientes
        },
        {
            id: 4,
            name: "Comandas",
            path: "/dashboard/comandas",
            icon: 
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="20" viewBox="0 0 27 20" fill="none">
                    <path className='fill-cream' d="M25.8322 11.667H20.8324H0.833298C0.373317 11.667 0 12.0403 0 12.5003V15.8335C0 18.1317 1.86992 20 4.16649 20H17.4992C19.5125 20 21.1941 18.5667 21.5807 16.6668H25.8322C26.2922 16.6668 26.6655 16.2935 26.6655 15.8335V12.5003C26.6655 12.0403 26.2922 11.667 25.8322 11.667Z" fill="white"/>
                    <path className='fill-cream' d="M17.3925 4.59224C16.8392 3.60728 17.1859 3.16563 17.2409 3.10397C17.5642 2.79565 17.5892 2.284 17.2892 1.94735C16.9825 1.60237 16.4542 1.5707 16.1126 1.87736C16.0542 1.93069 14.6876 3.1823 15.9392 5.40887C16.5042 6.41216 16.1342 6.85214 16.1126 6.87714C15.7693 7.18213 15.7359 7.71044 16.0426 8.05376C16.2076 8.23875 16.4359 8.33374 16.6659 8.33374C16.8625 8.33374 17.0609 8.26375 17.2192 8.12375C17.2775 8.07209 18.6441 6.81881 17.3925 4.59224Z" fill="white"/>
                    <path className='fill-cream' d="M11.5589 2.92573C11.0056 1.94078 11.3522 1.49913 11.4072 1.43747C11.7305 1.12915 11.7539 0.6175 11.4555 0.280848C11.1489 -0.0641368 10.6222 -0.0958019 10.2789 0.210851C10.2189 0.264182 8.85398 1.51579 10.1056 3.74237C10.6706 4.74566 10.2989 5.18564 10.2789 5.21064C9.93394 5.51562 9.90394 6.04393 10.2089 6.38725C10.3739 6.57224 10.6022 6.66724 10.8322 6.66724C11.0289 6.66724 11.2272 6.59724 11.3855 6.45725C11.4455 6.40558 12.8105 5.15231 11.5589 2.92573Z" fill="white"/>
                    <path className='fill-cream' d="M5.72586 4.59273C5.17255 3.60777 5.5192 3.16612 5.5742 3.10446C5.89752 2.79614 5.92085 2.28449 5.62253 1.94784C5.31588 1.60286 4.78923 1.57119 4.44591 1.87784C4.38592 1.93117 3.02097 3.18279 4.27259 5.40936C4.83756 6.41265 4.46591 6.85263 4.44591 6.87763C4.10093 7.18262 4.07093 7.71093 4.37592 8.05424C4.54091 8.23924 4.76923 8.33423 4.99922 8.33423C5.19588 8.33423 5.39421 8.26424 5.55253 8.12424C5.61253 8.07258 6.97747 6.8193 5.72586 4.59273Z" fill="white"/>
                </svg>
            ,
            allowedRoles: ['admin', 'encargado'] // Solo admin y encargado
        },
        {
            id: 5,
            name: "Usuarios",
            path: "/dashboard/usuarios",
            icon:
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="18" viewBox="0 0 27 20" fill="none">
                    <path className='fill-cream' fillRule="evenodd" clipRule="evenodd" d="M3.99219 6C3.99219 2.68629 6.67848 0 9.99219 0C13.3059 0 15.9922 2.68629 15.9922 6C15.9922 9.31373 13.3059 12 9.99219 12C6.67848 12 3.99219 9.31373 3.99219 6Z" fill="white"/>
                    <path className='fill-cream' d="M16.4815 9.41776C16.4208 9.53269 16.4466 9.67603 16.551 9.75336C17.3264 10.3274 18.286 10.6668 19.3248 10.6668C21.9022 10.6668 23.9915 8.57749 23.9915 6.00016C23.9915 3.42283 21.9022 1.3335 19.3248 1.3335C18.286 1.3335 17.3264 1.67296 16.551 2.247C16.4466 2.32434 16.4208 2.4676 16.4815 2.58255C17.02 3.60308 17.3248 4.76603 17.3248 6.00016C17.3248 7.23429 17.02 8.39723 16.4815 9.41776Z" fill="white"/>
                    <path className='fill-cream' fillRule="evenodd" clipRule="evenodd" d="M3.51307 14.2659C5.15622 13.5527 7.31213 13.3335 9.99147 13.3335C12.6731 13.3335 14.8306 13.5531 16.4743 14.2679C18.2649 15.0464 19.3531 16.3726 19.9235 18.245C20.1909 19.1226 19.5317 20.0002 18.6233 20.0002H1.36222C0.452724 20.0002 -0.207863 19.1212 0.0602972 18.242C0.631457 16.3694 1.72138 15.0436 3.51307 14.2659Z" fill="white"/>
                    <path className='fill-cream' d="M17.0833 12.0485C16.5313 12.0828 16.4989 12.8244 17.0061 13.0449C18.396 13.6493 19.4425 14.5391 20.1931 15.6747C20.8089 16.6065 21.7653 17.3333 22.8823 17.3333H25.2564C26.1993 17.3333 26.8873 16.3964 26.5556 15.4811C26.5365 15.4284 26.5167 15.3761 26.4961 15.3243C26.0396 14.1715 25.2571 13.3228 24.0984 12.7819C23.0105 12.274 21.6487 12.0644 20.0443 12.0011L20.0179 12H19.9916C19.0465 12 18.0595 11.9879 17.0833 12.0485Z" fill="white"/>
                </svg>
            ,
            allowedRoles: ['admin'] // Solo admin
        }
    ];

    return (
        <nav className="h-screen top-0 bg-cream-dark text-beef overflow-auto font-flame flex flex-col border-r border-beef/10 ">
            <div className='grid relative place-items-center gap-2 mb-8'>
                <div className='absolute w-full h-full grid grid-rows-6'>
                    <div className='bg-cheddar'></div>
                    <div className='bg-ketchup'></div>
                    <div className='bg-lettuce'></div>
                    <div className='bg-mustard'></div>
                    <div className='bg-beef-light'></div>
                    <div className='bg-beef'></div>
                </div>
                <div className='absolute z-10 w-full h-full grid place-items-center'>
                    <div className='absolute w-2/5 aspect-square rounded-full bg-white'></div>
                </div>
                <LogoStroke className={"max-w-14 relative z-20 "} bunStroke={"#FF6F00"} hungryStroke={"#2B0200"} joeStroke={"#2B0200"} />
            </div>
            <ul className="flex flex-col gap-3 max-w-full h-fit grow">
                {links.map(link => (
                    // Solo mostrar el enlace si el usuario tiene el rol permitido
                    link.allowedRoles.includes(usuario.rol) && (
                        <li key={link.id}>
                            <NavLink
                                to={link.path}
                                end={link.path === "/dashboard"}
                                className={({ isActive }) => `
                                    w-full py-3 px-6  relative block  group
                                    ${isActive ? 'text-cheddar' : 'bg-transparent'}
                                `}
                            >
                                <div
                                    style={{transition:'opacity 1400ms cubic-bezier(.08,.82,.17,1)',background:"linear-gradient(90deg, rgba(250,250,250,1) 48%, rgba(250,250,250,0) 100%)"}}
                                    className='z-0 group-[.text-cheddar]:opacity-100 opacity-0 group-hover:opacity-100   bg-cream-light border-l-4 border-cheddar absolute w-full h-full top-0 left-0'
                                >
                                </div>

                                <div className='z-10 relative flex gap-2 items-center'>
                                    <div className='w-10 bg-beef-light group-[.text-cheddar]:bg-cheddar group-hover:bg-cheddar rounded-full grid place-items-center aspect-square transition-colors'>
                                        {link.icon}
                                    </div>
                                    <span className='group-hover:text-cheddar transition-colors' >{link.name}</span>
                                </div>
                                

                            </NavLink>
                        </li>
                    )
                ))}

                {/* Si es un cliente osea una mesa, se tiene que poner el boton de pedir la cuenta para acabar la sesion
                    por ahora le pongo el onclick de logout
                */ }
                {usuario.rol !== "Aqui va el rol de mesa o cliente" && (<li className='mt-auto mb-12'>
                    <button onClick={logout} className={`w-[95%]  m-[2.5%] p-5 bg-white  relative block  group bg-transparent`}>
                        <div
                            style={{ transition: 'opacity 1400ms cubic-bezier(.08,.82,.17,1)' }}
                            className='z-0 group-[.text-cheddar]:opacity-100 opacity-0 group-hover:opacity-100   bg-cream-light border-2 border-cheddar  absolute w-full h-full top-0 left-0'
                        >
                        </div>

                        <div className='z-10 relative flex gap-2 items-center'>
                            <div className='w-10 bg-beef-light group-[.text-cheddar]:bg-cheddar group-hover:bg-cheddar rounded-full grid place-items-center aspect-square transition-colors'>
                                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="15" viewBox="0 0 27 20" fill="none">
                                    <path className='fill-cream' d="M0 8.88574V16.6667C0 18.5077 1.49239 20.0001 3.33333 20.0001H23.3333C25.1743 20.0001 26.6667 18.5077 26.6667 16.6667V8.88574C26.6361 8.88785 26.6052 8.88896 26.5741 8.88896H0.0925927C0.0614378 8.88896 0.0305594 8.88785 0 8.88574Z" fill="black"/>
                                    <path className='fill-cream' d="M26.6667 6.6699V3.33333C26.6667 1.49239 25.1743 0 23.3333 0H3.33333C1.49239 0 0 1.49239 0 3.33333V6.6699C0.0305594 6.66775 0.0614378 6.66667 0.0925927 6.66667H26.5741C26.6052 6.66667 26.6361 6.66775 26.6667 6.6699Z" fill="black"/>
                                </svg>
                            </div>
                            <span className='group-hover:text-cheddar transition-colors' >Pedir la Cuenta</span>
                        </div>
                               

                    </button>
                </li>)}
                            
            </ul>


            
        </nav>
    );
}